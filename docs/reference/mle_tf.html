<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>mle_tf function — mle_tf • estimtf</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="mle_tf function — mle_tf" />
<meta property="og:description" content="Function to find the Maximum Likelihood Estimates of distributional parameters using TensorFlow." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimtf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SaraGarcesCespedes/estimtf/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>mle_tf function</h1>
    <small class="dont-index">Source: <a href='https://github.com/SaraGarcesCespedes/estimtf/blob/master/R/mle_tf.R'><code>R/mle_tf.R</code></a></small>
    <div class="hidden name"><code>mle_tf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to find the Maximum Likelihood Estimates of distributional parameters using TensorFlow.</p>
    </div>

    <pre class="usage"><span class='fu'>mle_tf</span><span class='op'>(</span>
  <span class='va'>x</span>,
  xdist <span class='op'>=</span> <span class='st'>"Normal"</span>,
  fixparam <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>initparam</span>,
  bounds <span class='op'>=</span> <span class='cn'>NULL</span>,
  optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
  hyperparameters <span class='op'>=</span> <span class='cn'>NULL</span>,
  maxiter <span class='op'>=</span> <span class='fl'>10000</span>,
  tolerance <span class='op'>=</span> <span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a vector containing the data to be fitted.</p></td>
    </tr>
    <tr>
      <th>xdist</th>
      <td><p>a character indicating the name of the distribution of interest. The default value is <code>'Normal'</code>.
The available distributions are: <code>Normal</code>, <code>Poisson</code>, <code>Binomial</code>, <code>Weibull</code>, <code>Exponential</code>, <code>LogNormal</code>, <code>Beta</code> and <code>Gamma</code>.
If you want to estimate parameters from a distribution different to the ones mentioned above, you must provide the
name of an object of class function that contains its probability mass/density function. This <code>R</code> function must not contain curly brackets
other than those that enclose the function.</p></td>
    </tr>
    <tr>
      <th>fixparam</th>
      <td><p>a list containing the fixed parameters of the distribution of interest only if they exist. The parameters values and names must be specified in the list.</p></td>
    </tr>
    <tr>
      <th>initparam</th>
      <td><p>a list with initial values of the parameters to be estimated. The list must contain the parameters values and names.</p></td>
    </tr>
    <tr>
      <th>bounds</th>
      <td><p>a list with lower and upper bounds for each parameter to be estimated. The list must contain the parameters names and vectors with the bounds. The default value is NULL.</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>a character indicating the name of the TensorFlow optimizer to be used in the estimation process The default value is <code>'AdamOptimizer'</code>. The available optimizers are:
<code>"AdadeltaOptimizer"</code>, <code>"AdagradDAOptimizer"</code>, <code>"AdagradOptimizer"</code>, <code>"AdamOptimizer"</code>, <code>"GradientDescentOptimizer"</code>,
<code>"MomentumOptimizer"</code> and <code>"RMSPropOptimizer"</code>.</p></td>
    </tr>
    <tr>
      <th>hyperparameters</th>
      <td><p>a list with the hyperparameters values of the selected TensorFlow optimizer. If the hyperparameters are not specified, their default values
will be used in the oprimization process. For more details of the hyperparameters go to this URL:
<a href='https://www.tensorflow.org/api_docs/python/tf/compat/v1/train'>https://www.tensorflow.org/api_docs/python/tf/compat/v1/train</a></p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>a positive integer indicating the maximum number of iterations for the optimization algorithm. The default value is <code>10000</code>.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>a small positive number. When the difference between the loss value or the parameters values from one iteration to another is lower
than this value, the optimization process stops. The default value is <code>.Machine$double.eps</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns the estimates, standard errors, Z-score and p-values of significance tests of the parameters from the distribution of interest as well as
some information of the optimization process like the number of iterations needed for convergence.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>mle_tf</code> computes the log-likelihood function of the distribution specified in
<code>xdist</code> and finds the values of the parameters that maximizes this function using the TensorFlow optimizer
specified in <code>optimizer</code>.</p>
<p>The <code>R</code> function that contains the probability mass/density function must not contain curly brackets. The only curly brackets that the function can contain are those that enclose the function,
 that is, those that define the beginning and end of the <code>R</code> function.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>summary, print, plot_loss</code> functions can be used with a <code>mle_tf</code> object.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sara Garcés Céspedes <a href='mailto:sgarcesc@unal.edu.co'>sgarcesc@unal.edu.co</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#-----------------------------------------------------------------------------</span>
<span class='co'># Estimation of parameters mean and sd of the normal distribution</span>

<span class='co'># Vector with the data to be fitted</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1000</span>, mean <span class='op'>=</span> <span class='fl'>10</span>, sd <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='co'># Use the mle_tf function</span>
<span class='va'>estimation_1</span> <span class='op'>&lt;-</span> <span class='fu'>mle_tf</span><span class='op'>(</span><span class='va'>x</span>,
                       xdist <span class='op'>=</span> <span class='st'>"Normal"</span>,
                       optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
                       initparam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>1.0</span>, sd <span class='op'>=</span> <span class='fl'>1.0</span><span class='op'>)</span>,
                       hyperparameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>learning_rate <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Get the summary of the estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>estimation_1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Distribution: Normal 
#&gt; Number of observations: 1000 
#&gt; TensorFlow optimizer: AdamOptimizer 
#&gt; Negative log-likelihood: 653.9305 
#&gt; Loss function convergence, 1193 iterations needed. 
#&gt; ---------------------------------------------------
#&gt;      Estimate  Std. Error Z value Pr(&gt;|z|)    
#&gt; mean  10.05937    0.09270  108.52   &lt;2e-16 ***
#&gt; sd     2.93144    0.06581   44.55   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</div><div class='input'>
<span class='co'>#-----------------------------------------------------------------------------</span>
<span class='co'># Estimation of parameter lambda of the Instantaneous Failures distribution</span>

<span class='co'># Create an R function that contains the probability density function</span>
<span class='va'>pdf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>lambda</span><span class='op'>)</span> <span class='op'>{</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>lambda</span> <span class='op'>^</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>lambda</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>*</span>
                             <span class='op'>(</span><span class='va'>lambda</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>X</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='va'>lambda</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>X</span><span class='op'>/</span><span class='va'>lambda</span><span class='op'>)</span> <span class='op'>}</span>

<span class='co'># Vector with the data to be fitted</span>
<span class='va'>x</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3.4</span>, <span class='fl'>0.0</span>, <span class='fl'>0.0</span>, <span class='fl'>15.8</span>, <span class='fl'>232.8</span>, <span class='fl'>8.8</span>, <span class='fl'>123.2</span>, <span class='fl'>47</span>, <span class='fl'>154</span>, <span class='fl'>103.2</span>, <span class='fl'>89.8</span>,  <span class='fl'>12.2</span><span class='op'>)</span>

<span class='co'># Use the mle_tf function</span>
<span class='va'>estimation_2</span> <span class='op'>&lt;-</span> <span class='fu'>mle_tf</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>,
                       xdist <span class='op'>=</span> <span class='va'>pdf</span>,
                       initparam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
                       bounds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>)</span>,
                       optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
                       hyperparameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>learning_rate <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
                       maxiter <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span>

<span class='co'># Get the summary of the estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>estimation_2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Number of observations: 12 
#&gt; TensorFlow optimizer: AdamOptimizer 
#&gt; Negative log-likelihood: 62.2489 
#&gt; Loss function convergence, 97 iterations needed. 
#&gt; ---------------------------------------------------
#&gt;        Estimate  Std. Error Z value Pr(&gt;|z|)
#&gt; lambda     64.89         NA      NA       NA</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sara Garces.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


