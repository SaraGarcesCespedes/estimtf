<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>mlereg_tf function — mlereg_tf • estimtf</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="mlereg_tf function — mlereg_tf" />
<meta property="og:description" content="Function to find the Maximum Likelihood Estimates of regression parameters using TensorFlow." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimtf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SaraGarcesCespedes/estimtf/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>mlereg_tf function</h1>
    <small class="dont-index">Source: <a href='https://github.com/SaraGarcesCespedes/estimtf/blob/master/R/mlereg_tf.R'><code>R/mlereg_tf.R</code></a></small>
    <div class="hidden name"><code>mlereg_tf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to find the Maximum Likelihood Estimates of regression parameters using TensorFlow.</p>
    </div>

    <pre class="usage"><span class='fu'>mlereg_tf</span><span class='op'>(</span>
  ydist <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>Normal</span>,
  <span class='va'>formulas</span>,
  <span class='va'>data</span>,
  available_distribution <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fixparam <span class='op'>=</span> <span class='cn'>NULL</span>,
  initparam <span class='op'>=</span> <span class='cn'>NULL</span>,
  link_function <span class='op'>=</span> <span class='cn'>NULL</span>,
  optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
  hyperparameters <span class='op'>=</span> <span class='cn'>NULL</span>,
  maxiter <span class='op'>=</span> <span class='fl'>10000</span>,
  tolerance <span class='op'>=</span> <span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ydist</th>
      <td><p>an object of class "formula" that specifies the distribution of the response variable. The default value is <code>y ~ Normal</code>.
The available distributions are: <code>Normal</code>, <code>Poisson</code>, <code>Weibull</code>, <code>Exponential</code>, <code>LogNormal</code>,
<code>Beta</code> and <code>Gamma</code>. If you want to estimate parameters from a distribution different to the ones mentioned above, you must provide the
name of an object of class function that contains its probability mass/density function. This <code>R</code> function must not contain curly brackets
other than those that enclose the function.</p></td>
    </tr>
    <tr>
      <th>formulas</th>
      <td><p>a list containing objects of class "formula". Each element of the list represents the
linear predictor for each of the parameters of the regression model. The linear predictor is specified with
the name of the parameter and it must contain an <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code>. The terms on the right side must be separated by <code><a href='https://rdrr.io/r/base/Arithmetic.html'>+</a></code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the response variable and the covariates.</p></td>
    </tr>
    <tr>
      <th>available_distribution</th>
      <td><p>logical. If <code>TRUE</code>, the distribution of the response variable is one of the following distributions: <code>Normal</code>,
<code>Poisson</code>, <code>Weibull</code>, <code>Exponential</code>, <code>LogNormal</code>, <code>Beta</code> and <code>Gamma</code>.</p></td>
    </tr>
    <tr>
      <th>fixparam</th>
      <td><p>a list containing the fixed parameters of the model only if they exist. The parameters values and names must be specified in the list.</p></td>
    </tr>
    <tr>
      <th>initparam</th>
      <td><p>a list with the initial values of the regression coefficients to be estimated. The list must contain the regression coefficients values and names.
If you want to use the same initial values for all regression coefficients associated with a specific parameter, you can specify the
name of the parameter and the value. If NULL the default initial value is zero.</p></td>
    </tr>
    <tr>
      <th>link_function</th>
      <td><p>a list with names of parameters to be linked and the corresponding link function name. The available link functions are:
<code>log</code>, <code>logit</code>, <code>squared</code> and <code>identity</code>.</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>a character indicating the name of the TensorFlow optimizer to be used in the optimization process. The default value is <code>AdamOptimizer</code>. The available optimizers are:
<code>AdadeltaOptimizer</code>, <code>AdagradDAOptimizer</code>, <code>AdagradOptimizer</code>, <code>AdamOptimizer</code>, <code>GradientDescentOptimizer</code>,
<code>MomentumOptimizer</code> and <code>RMSPropOptimizer</code>.</p></td>
    </tr>
    <tr>
      <th>hyperparameters</th>
      <td><p>a list with the hyperparameters values of the selected TensorFlow optimizer. If the hyperparameters are not specified, their default values
will be used in the oprimization process. For more details of the hyperparameters go to this URL:
<a href='https://www.tensorflow.org/api_docs/python/tf/compat/v1/train'>https://www.tensorflow.org/api_docs/python/tf/compat/v1/train</a></p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>a positive integer indicating the maximum number of iterations for the optimization algorithm. The default value is <code>10000</code>.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>a small positive number. When the difference between the loss value or the parameters values from one iteration to another is lower
than this value, the optimization process stops. The default value is <code>.Machine$double.eps</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns the estimates, standard errors, Z-score and p-values of significance tests
of the regression model coefficients as well as some information of the optimization process like the number of
iterations needed for convergence.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>mlereg_tf</code> computes the log-likelihood function based on the distribution specified in
<code>ydist</code> and linear predictors specified in <code>formulas</code>. Then, it finds the values of the regression coefficients
that maximizes this function using the TensorFlow opimizer specified in <code>optimizer</code>.</p>
<p>The <code>R</code> function that contains the probability mass/density function must not contain curly brackets. The only curly brackets that the function can contain are those that enclose the function,
that is, those that define the beginning and end of the <code>R</code> function.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>summary, print, plot_loss</code> functions can be used with a <code>mlereg_tf</code> object.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sara Garcés Céspedes <a href='mailto:sgarcesc@unal.edu.co'>sgarcesc@unal.edu.co</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#----------------------------------------------------------------------------------</span>
<span class='co'># Estimation of coefficients of a Poisson regression model</span>

<span class='co'># Data frame with response variable and covariates</span>
<span class='va'>counts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>18</span>,<span class='fl'>17</span>,<span class='fl'>15</span>,<span class='fl'>20</span>,<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>25</span>,<span class='fl'>13</span>,<span class='fl'>12</span><span class='op'>)</span>
<span class='va'>outcome</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/gl.html'>gl</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>9</span><span class='op'>)</span>
<span class='va'>treatment</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/gl.html'>gl</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>treatment</span>, <span class='va'>outcome</span>, <span class='va'>counts</span><span class='op'>)</span>

<span class='co'># Use the mlereg_tf function</span>
<span class='va'>estimation_1</span> <span class='op'>&lt;-</span> <span class='fu'>mlereg_tf</span><span class='op'>(</span>ydist <span class='op'>=</span>  <span class='va'>counts</span> <span class='op'>~</span> <span class='va'>Poisson</span>,
                          formulas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='op'>~</span> <span class='va'>outcome</span> <span class='op'>+</span> <span class='va'>treatment</span><span class='op'>)</span>,
                          data <span class='op'>=</span> <span class='va'>data</span>,
                          initparam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='fl'>1.0</span><span class='op'>)</span>,
                          optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
                          link_function <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='st'>"log"</span><span class='op'>)</span>,
                          hyperparameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>learning_rate <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Get the summary of the estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>estimation_1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Distribution: Poisson 
#&gt; Number of observations: 9 
#&gt; TensorFlow optimizer: AdamOptimizer 
#&gt; Negative log-likelihood: -274.7378 
#&gt; Loss function convergence, 110 iterations needed. 
#&gt; ----------------------------------------------------------------
#&gt; Distributional parameter: lambda
#&gt; ----------------------------------------------------------------
#&gt;              Estimate. Std..Error Z.value Pr...z..    
#&gt; (Intercept)  3.0446310  0.1708925  17.816   &lt;2e-16 ***
#&gt; outcome2    -0.4541281  0.2021639  -2.246   0.0247 *  
#&gt; outcome3    -0.2930921  0.1927491  -1.521   0.1284    
#&gt; treatment2  -0.0001777  0.1999979  -0.001   0.9993    
#&gt; treatment3  -0.0001776  0.1999979  -0.001   0.9993    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; ----------------------------------------------------------------</div><div class='input'>
<span class='co'>#----------------------------------------------------------------------------------</span>
<span class='co'># Estimation of coefficients of a linear regression model with one fixed parameter</span>

<span class='co'># Data frame with response variable and covariates</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1000</span>, <span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1000</span>, mean <span class='op'>=</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>x</span>, sd <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>

<span class='co'># Use the mlereg_tf function</span>
<span class='va'>estimation_2</span> <span class='op'>&lt;-</span> <span class='fu'>mlereg_tf</span><span class='op'>(</span>ydist <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>Normal</span>,
                          formulas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>,
                          data <span class='op'>=</span> <span class='va'>data</span>,
                          fixparam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sd <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
                          initparam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Intercept <span class='op'>=</span> <span class='fl'>1.0</span>, x <span class='op'>=</span> <span class='fl'>0.0</span><span class='op'>)</span><span class='op'>)</span>,
                          optimizer <span class='op'>=</span> <span class='st'>"AdamOptimizer"</span>,
                          hyperparameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>learning_rate <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Get the summary of the estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>estimation_2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Distribution: Normal 
#&gt; Number of observations: 1000 
#&gt; TensorFlow optimizer: AdamOptimizer 
#&gt; Negative log-likelihood: 652.0222 
#&gt; Loss function convergence, 115 iterations needed. 
#&gt; ----------------------------------------------------------------
#&gt; Distributional parameter: mean
#&gt; ----------------------------------------------------------------
#&gt;             Estimate. Std..Error Z.value Pr...z..    
#&gt; (Intercept)   4.86203    0.09489   51.24   &lt;2e-16 ***
#&gt; x            -1.95539    0.05372  -36.40   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; ----------------------------------------------------------------</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sara Garces.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


